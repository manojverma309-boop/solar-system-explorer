<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Galaxy Types – Cinematic Space</title>
<style>
html,body{
  margin:0;
  width:100%;
  height:100%;
  overflow:hidden;
  background:#02040c;
  font-family:system-ui;
}
#bgCanvas{position:fixed;inset:0;z-index:0;}
#threeContainer{position:fixed;inset:0;z-index:1;}
#panel{
  position:fixed;
  top:10px;
  left:10px;
  z-index:5;
  display:flex;
  flex-direction:column;
}
#panel button{
  margin:4px 0;
  padding:8px 14px;
  border:none;
  border-radius:8px;
  cursor:pointer;
  font-weight:bold;
  color:#fff;
  background:linear-gradient(45deg,#88ccff,#ff88cc);
  transition: all 0.3s;
  box-shadow:0 0 4px #000;
}
#panel button.active,
#panel button:hover{
  box-shadow:0 0 16px #ff88cc,0 0 32px #88ccff;
}
.bgPanel{
  position:fixed;
  right:12px;
  bottom:12px;
  z-index:5;
  background:rgba(0,0,0,.6);
  padding:10px 14px;
  border-radius:12px;
  color:#fff;
  font-size:12px;
}
.bgPanel input{width:160px}
</style>
</head>
<body>

<canvas id="bgCanvas"></canvas>
<div id="threeContainer"></div>

<div id="panel">
  <button onclick="loadGalaxy('spiral',this)">Spiral</button>
  <button onclick="loadGalaxy('elliptical',this)">Elliptical</button>
  <button onclick="loadGalaxy('ring',this)">Ring</button>
  <button onclick="loadGalaxy('irregular',this)">Irregular</button>
  <button onclick="loadGalaxy('dwarf',this)">Dwarf</button>
</div>

<div class="bgPanel">
  ⭐ Star Speed<br>
  <input type="range" id="speed" min="0.5" max="8" value="4">
</div>

<!-- 2D background -->
<script>
const bg = document.getElementById("bgCanvas");
const ctx = bg.getContext("2d");
function resizeBG(){ bg.width = innerWidth; bg.height = innerHeight; }
addEventListener("resize",resizeBG);
resizeBG();
let SPEED = 4;
document.getElementById("speed").oninput = e => SPEED = +e.target.value;
const bgStars=[]; const DEPTH=1200;
for(let i=0;i<1400;i++){
  bgStars.push({x:(Math.random()-0.5)*innerWidth,y:(Math.random()-0.5)*innerHeight,z:Math.random()*DEPTH,s:Math.random()*1.5+0.5});
}
function drawBG(){
  ctx.fillStyle="#02040c";
  ctx.fillRect(0,0,bg.width,bg.height);
  ctx.translate(bg.width/2,bg.height/2);
  ctx.globalCompositeOperation="lighter";
  for(const s of bgStars){
    s.z-=SPEED;
    if(s.z<1) s.z=DEPTH;
    const k=300/s.z;
    ctx.fillStyle="#88ccff";
    ctx.fillRect(s.x*k,s.y*k,s.s,s.s);
  }
  ctx.setTransform(1,0,0,1,0,0);
  requestAnimationFrame(drawBG);
}
drawBG();
</script>

<script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
<script>
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x02040c);
const camera = new THREE.PerspectiveCamera(60,innerWidth/innerHeight,0.1,2000);
camera.position.z = 120;
const renderer = new THREE.WebGLRenderer({antialias:true, alpha:false});
renderer.setSize(innerWidth,innerHeight);
renderer.setPixelRatio(devicePixelRatio);
renderer.setClearColor(0x02040c,1);
document.getElementById("threeContainer").appendChild(renderer.domElement);

/* Space stars */
const starGeo = new THREE.BufferGeometry();
const starCount = 40000;
const starPos = new Float32Array(starCount*3);
for(let i=0;i<starCount;i++){
  starPos[i*3]=(Math.random()-0.5)*1000;
  starPos[i*3+1]=(Math.random()-0.5)*1000;
  starPos[i*3+2]=(Math.random()-0.5)*1000;
}
starGeo.setAttribute("position",new THREE.BufferAttribute(starPos,3));
const sprite = new THREE.TextureLoader().load("https://threejs.org/examples/textures/sprites/circle.png");
const spaceStars = new THREE.Points(starGeo,new THREE.PointsMaterial({map:sprite,size:1.2,color:0xffffff}));
scene.add(spaceStars);

let galaxy, core;

function loadGalaxy(type,btn){
  if(galaxy) scene.remove(galaxy);
  if(core) scene.remove(core);

  document.querySelectorAll('#panel button').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');

  const geo = new THREE.BufferGeometry();
  const count = 16000;
  const pos = new Float32Array(count*3);
  const col = new Float32Array(count*3);

  for(let i=0;i<count;i++){
    let x=0,y=0,z=0;
    const r=Math.random()*50;

    if(type==="spiral"){ const a=(i%4)/4*Math.PI*2+r*0.25; x=Math.cos(a)*r; z=Math.sin(a)*r; }
    else if(type==="elliptical"){
      const theta=Math.random()*2*Math.PI;
      const phi=Math.acos(2*Math.random()-1);
      const rx=35+Math.random()*5, ry=25+Math.random()*5, rz=12+Math.random()*3;
      x=rx*Math.sin(phi)*Math.cos(theta);
      y=ry*Math.sin(phi)*Math.sin(theta);
      z=rz*Math.cos(phi);
    }
    else if(type==="ring"){ const a=Math.random()*Math.PI*2; const rr=30+Math.random()*4; x=Math.cos(a)*rr; z=Math.sin(a)*rr; }
    else if(type==="irregular"){
  // Irregular galaxy: more cloud-like, flattened distribution
  const theta = Math.random()*2*Math.PI;
  const phi = (Math.random()-0.5)*Math.PI*0.4; // flattened vertically
  const r = 30 + Math.random()*30;
  x = r * Math.cos(phi) * Math.cos(theta);
  y = r * Math.sin(phi);
  z = r * Math.cos(phi) * Math.sin(theta);
}

    else{ x=(Math.random()-0.5)*15; y=(Math.random()-0.5)*15; z=(Math.random()-0.5)*15; }

    pos[i*3]=x; pos[i*3+1]=y; pos[i*3+2]=z;

    const h=(i/count)+Math.random()*0.2;
    const c=new THREE.Color().setHSL(h,0.7,0.6);
    col[i*3]=c.r; col[i*3+1]=c.g; col[i*3+2]=c.b;
  }

  geo.setAttribute("position",new THREE.BufferAttribute(pos,3));
  geo.setAttribute("color",new THREE.BufferAttribute(col,3));

  galaxy = new THREE.Points(
    geo,
    new THREE.PointsMaterial({map:sprite,size:0.45,vertexColors:true,transparent:true,blending:THREE.AdditiveBlending})
  );
  scene.add(galaxy);

  core = new THREE.Mesh(
    new THREE.SphereGeometry(5,32,32),
    new THREE.MeshBasicMaterial({color:0xffffff})
  );
  scene.add(core);
}
loadGalaxy("spiral",document.querySelector("#panel button"));

/* Mouse control */
let down=false,lx=0,ly=0,rx=0,ry=0;
renderer.domElement.onmousedown=e=>{down=true; lx=e.clientX; ly=e.clientY;};
onmouseup=()=>down=false;
onmousemove=e=>{
  if(!down) return;
  ry+=(e.clientX-lx)*0.003;
  rx+=(e.clientY-ly)*0.003;
  scene.rotation.set(rx,ry,0);
  lx=e.clientX; ly=e.clientY;
};
onwheel=e=>{
  camera.position.z+=e.deltaY*0.05;
  camera.position.z=Math.max(40,Math.min(200,camera.position.z));
};

/* Animate */
function animate(){
  requestAnimationFrame(animate);
  if(galaxy) galaxy.rotation.y+=0.0015;
  spaceStars.rotation.y+=0.0004;
  if(core) core.scale.setScalar(1+Math.sin(performance.now()*0.002)*0.05);
  renderer.render(scene,camera);
}
animate();

/* Resize */
onresize=()=>{
  camera.aspect=innerWidth/innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(innerWidth,innerHeight);
};
</script>
</body>
</html>
